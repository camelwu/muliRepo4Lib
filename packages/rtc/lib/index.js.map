{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["/**\n * @description [声网, 腾讯, 即构]3家sdk的备线，因3家sdk的api和init方法和流程有差别，编写空对象，引入三家SDK。根据适配模式对外暴露方法。\n *              首先，调用`line`参数，根据`line`对sdk初始化`rtc`，再create`Client`；\n *              提供对外的on等方法，请见注释\n * @param {Number} line\n * @param {Object} option\n *\n */\n\nimport { EventEmitter } from 'events';\nimport AgoraRTC from 'agora-rtc-sdk';\nimport TRTC from 'trtc-js-sdk';\nimport { ZegoClient as ZRTC } from 'webrtc-zego';\n\nexport interface NetDatas {\n  up: Map<string, NetData>;\n  down: Map<string, NetData>;\n}\n\nexport interface NetData {\n  video: {\n      /** 视频丢包率 */\n      vplr: any;\n      /** 视频当前延迟 */\n      vcd: any;\n      /** 视频带宽 */\n      vbps: any;\n      /** 视频帧率 */\n      vfr: any;\n      /** 视频分辨率-宽 */\n      vfw: any;\n      /** 视频分辨率-高 */\n      vfh: any;\n      /** 视频端到端延迟 */\n      ve2ed?: any;\n      /** 静音状态 */\n      vms?: any;\n  };\n  audio: {\n      /** 音频丢包率 */\n      aqlr: any;\n      /** 音频带宽 */\n      abps: any;\n      /** 音频质量 */\n      anq: any;\n      /** 音频是否静音 */\n      ams?: any;\n  };\n}\n\nexport interface Device {\n  client: any;\n  domId?: string;\n  streamID?: number;\n  cameraId: string | void | any;\n  microphoneId?: string;\n  audio?: boolean;\n  video?: boolean;\n  screen?: boolean;\n  mirror?: boolean;\n}\n\nexport type model = {\n  mode: 'live' | 'rtc';\n  codec: 'vp8' | 'h264';\n};\n/**\n* @description main:主, vice:副\n*/\nexport enum streamType {\n  main = 0,\n  vice = 1,\n}\nexport enum zegoRole {\n  host = 1,\n  audience = 2,\n}\n\n/**\n * @description 因3家sdk的api和init方法和流程有差别，所以先引入skd，编写空对象，根据传入参数的不同，再进行逻辑编写\n */\nexport default class Rtc extends EventEmitter {\n  // params\n  private token: null | string = null;\n\n  private mainUid!: number;\n\n  // private mainUid!: number;\n  private appId!: string;\n  // params is better\n  private device!: Device;\n\n  private roomId!: string;\n\n  private model!: model;\n\n  private domMap: [{ main: string; vice: string }] | any;\n  // private members = new Map();\n\n  private line = 2;\n\n  // 备线数组，len=3\n  private sdk: [typeof AgoraRTC, ZRTC, typeof TRTC] = [AgoraRTC, new ZRTC(), TRTC];\n\n  public rtc: typeof AgoraRTC | ZRTC | typeof TRTC = TRTC;\n\n  public logLevel = 1;\n\n  public client: any;\n\n  public joined = false;\n\n  public published = false;\n\n  public localStream: any;\n\n  public remoteStreams: any[] = [];\n\n  public streamsList: any = {};\n\n  constructor(line: number) {\n    super();\n    // 定义client\n    this.switchSdk(line);\n  }\n\n  /**\n   * @description 设置用哪个sdk，公用方法\n   */\n  public switchSdk(line: number) {\n    if (this.line !== line) {\n      this.line = line;\n      this.rtc = this.sdk[line];\n    }\n  }\n\n  /**\n   * @description 初始化客户端对象\n   *\n   */\n  async init(option: any) {\n    /**\n     * @description 默认配置，部分采用事先配置好的`config`；这里导入`option`，并赋值\n     *\n     */\n    this.token = option.token || null;\n    this.roomId = option.roomId || null;\n    this.appId = option.appId;\n    this.model = option.model;\n    this.domMap = option.domMap;\n    this.device = option.device;\n    this.mainUid = +`${option.role}${streamType.main}${option.userId}`;\n    // 根据设备判断，现在的逻辑是直接建立两个`client`，是否有必要？\n    let client;\n    /**\n     * @description `creatClient` 考虑消化部分业务逻辑?\n     * 初始化的流程因为3家，以后更多可能也不同，直接暴露出client和stream吗？暂时先暴露方法\n     */\n    switch (this.line) {\n      case 1: // 腾讯\n        client = TRTC.createClient({\n          mode: this.model.mode,\n          sdkAppId: this.appId,\n          userId: this.mainUid,\n          userSig: sessionStorage.trtcToken,\n        });\n        break;\n      case 2: // 即构\n        client = new ZRTC();\n        // ? idName 不直接写 ?\n        // const _config = {};\n\n        client.config({\n          appid: +this.appId, // 必填，应用id，请从 即构管理控制台-https://console.zego.im/acount/register 获取\n          // idName: `${new Date().getTime()}`, // 必填，用户自定义id，全局唯一\n          nickName: `u${new Date().getTime()}`, // 必填，用户自定义昵称\n          server: 'wss://webliveroom-test.zego.im/ws', // 必填，接入服务器地址，请从 即构管理控制台-https://console.zego.im/acount/register 获取\n          logLevel: this.logLevel, // 日志级别，debug:0,info:1,warn:2,error:3,report:99,disable:100（数字越大，日志越少），建议选择 1\n          logUrl: '', // 必填，logServer 地址，请从 即构管理控制台-https://console.zego.im/acount/register 获取\n          remoteLogLevel: 0, // 上传日志最低级别，建议跟 logLevel 一致\n          audienceCreateRoom: false, // 是否允许观众创建房间\n          idName: `${this.mainUid}`,\n        });\n        break;\n      default:\n        // 声网\n        client = AgoraRTC.createClient(this.model);\n    }\n    this.client = client;\n    // 绑定事件到client，写多个函数？方便代码拆分\n    this.handleEvents(this.client);\n    // 加入房间：初始化`client`，`createStream`\n    await this.join(this.roomId, () => { });\n    // return client;\n  }\n\n  // just 4 zego\n  private loadLoginToken(loginUrl: string, id: number): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const xmlhttp = new XMLHttpRequest();\n      xmlhttp.onreadystatechange = () => {\n        if (xmlhttp.readyState === 4) {\n          if (xmlhttp.status === 200) {\n            const text: string = xmlhttp.responseText;\n            const regText = /token:(.+)/.exec(text);\n            const token = (\n              (regText && regText[1] && regText[1].replace(' ', ''))\n            ) as string;\n            resolve(token);\n          } else {\n            reject();\n          }\n        }\n      };\n\n      const appSigin =\n        '0x5f,0x2b,0x2c,0xa9,0x50,0xec,0x29,0x3c,0xef,0x85,0xbc,0xad,0x61,0x31,0xeb,0x21,0x87,0x72,0xa9,0xc0,0x47,0xaf,0xe3,0x62,0xdb,0x80,0xc3,0xdb,0xc9,0xe4,0xc0,0xd6';\n      const now = new Date().getTime();\n      const url = `${loginUrl}?app_id=${\n        this.appId\n        }&id_name=${id}&app_secret=${appSigin}&nonce=${now}&expired=${Math.floor(\n          now / 1000 + 30 * 60,\n        )}`;\n\n      xmlhttp.open('GET', url, true);\n      xmlhttp.send();\n    });\n  }\n\n  // just 4 zego\n  private playRemoteStream(streamList: any[], client: ZRTC) {\n    for (let i = 0; i < streamList.length; i++) {\n      const uid = streamList[i].stream_id;\n      console.info(`${uid} was added`);\n      this.streamsList[uid] = streamList[i];\n      console.log('this.streamsList :', this.streamsList);\n\n      if (!uid) return;\n      // 如果是副摄像头\n      // if (uid.substr(2) === getUserId()) return;\n\n      const type = uid.substr(1, 1) === '0' ? 'main' : 'vice';\n      const domId = this.domMap[0][type];\n\n      const dom = this.setVideoDomView({\n        domId,\n        streamID: `${streamList[i].stream_id}`,\n      });\n      client.startPlayingStream(uid, dom);\n      dom.muted = false;\n    }\n  }\n\n  // just 4 zego\n  private setVideoDomView({\n    domId,\n    streamID,\n  }: {\n    domId: string;\n    streamID: string;\n  }): HTMLVideoElement {\n    const domView = <HTMLElement>document.querySelector(`#${domId}`);\n    domView.innerHTML = `<div id=\"player_${streamID}\" style=\"width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;\"><video id=\"video${streamID}\" style=\"width: 100%; height: 100%; position: absolute; object-fit: contain;\" autoplay muted playsinline></video></div>`;\n\n    return <HTMLVideoElement>document.querySelector(`#${domId} video`);\n  }\n\n  public getstreams(): any {\n    return this.streamsList;\n  }\n\n  // 获取设备\n  getDevices(next: Function) {\n    switch (this.line) {\n      case 0:\n        AgoraRTC.getDevices(function (items) {\n          items\n            .filter(function (item) {\n              return ['audioinput', 'videoinput'].indexOf(item.kind) !== -1;\n            })\n            .map(function (item) {\n              return {\n                name: item.label,\n                value: item.deviceId,\n                kind: item.kind,\n              };\n            });\n          var videos: { name: String, value: String, kind: String }[] = [];\n          var audios: { name: String, value: String, kind: String }[] = [];\n          for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            if (item.kind == 'videoinput') {\n              var name = item.label;\n              var value = item.deviceId;\n              if (!name) {\n                name = `camera-${videos.length}`;\n              }\n              videos.push({\n                name,\n                value,\n                kind: item.kind,\n              });\n            }\n            if (item.kind == 'audioinput') {\n              var name = item.label;\n              var value = item.deviceId;\n              if (!name) {\n                name = `microphone-${audios.length}`;\n              }\n              audios.push({\n                name,\n                value,\n                kind: item.kind,\n              });\n            }\n          }\n          next({ videos, audios });\n        });\n        break;\n      case 1:\n        break;\n      default:\n        return ZRTC.enumDevices(next,function(error:String){console.log(`error:${error}`);});\n    }\n  }\n\n  // 登录房间 join\n  async join(_roomId: string, func: Function) {\n    // return new Promise((resolve, reject) => {}\n    const _self = this;\n    if (this.joined) {\n      console.warn('duplicate join() observed');\n      return;\n    }\n    if (this.line === 0) {\n      // aogra\n      const { client } = this;\n      // client\n      client.init(\n        this.appId,\n        () => {\n          console.log('aogra init success');\n          // 加入 AgoraRTC 频道\n          client.join(\n            this.token,\n            this.roomId,\n            this.mainUid,\n            () => {\n              this.joined = true;\n              func();\n              this.localStream = AgoraRTC.createStream({\n                audio: true,//false `divce` why ?\n                video: true,\n                screen: false,\n                mirror: false,\n                // client: this.client,\n                // domId: this.domMap[1].main,\n                streamID: this.mainUid,\n                cameraId: this.device.cameraId[0],\n                microphoneId: this.device.microphoneId,\n              });\n\n              this.localStream.on('player-status-change', (evt: any) => {\n                console.log('media local stream player-status-change :', evt);\n                if (evt.isErrorState && evt.status === 'paused') {\n                  console.warn(\n                    `local stream is paused unexpectedly. Trying to resume...`,\n                  );\n                  this.localStream\n                    .resume()\n                    .then(() => {\n                      console.log(`local stream is resumed successfully`);\n                    })\n                    .catch((e: any) => {\n                      console.error(\n                        `Failed to resume local stream. Error ${e.name} Reason ${e.message}`,\n                      );\n                    });\n                }\n              });\n              // init local stream\n              this.localStream.init(\n                function () {\n                  console.log('init local stream success');\n                  // play stream with html element id \"local_stream\"\n                  _self.localStream.play('local_stream');\n\n                  // publish local stream\n                  _self.publish();\n                },\n                function (err:String) {\n                  console.error('init local stream failed ', err);\n                },\n              );\n              this.streamsList[+this.mainUid] = this.localStream;\n            },\n            (err: string) => {\n              // 加入频道失败\n              console.error('client join fail', err);\n              const errType: any = {\n                TIMEOUT: 'join-timeout',\n                UID_CONFLICT: 'user-exist',\n              };\n              if (errType[err]) {\n                super.emit(errType[err] || 'join-fail');\n              }\n            },\n          );\n        },\n        (err: string) => {\n          // 初始化client失败\n          console.error('client init fail', err);\n        },\n      );\n    } else if (this.line === 1) {\n      // trtc\n      const { client } = this;\n      try {\n        // join the room\n        await client.join({\n          roomId: this.roomId,\n        });\n        console.log('trtc join room success');\n        this.joined = true;\n\n        // create a local stream with audio/video from microphone/camera\n        this.localStream = TRTC.createStream({\n          audio: true,\n          video: true,\n          userId: this.mainUid,\n          cameraId: this.device.cameraId[0],\n          microphoneId: this.device.microphoneId,\n          mirror: true,\n        });\n        try {\n          // initialize the local stream and the stream will be populated with audio/video\n          await this.localStream.initialize();\n          console.log('trtc local stream success');\n\n          this.localStream.on('player-state-changed', (event:any) => {\n            console.log(`local stream ${event.type} player is ${event.state}`);\n          });\n\n          // publish the local stream\n          await this.publish();\n\n          // this.localStream.play('main-video');\n          // dom 渲染\n        } catch (e) {\n          console.error(`failed to initialize local stream - ${e}`);\n        }\n      } catch (e) {\n        console.error(`join room failed! ${e}`);\n      }\n      // 更新成员状态\n      const states = client.getRemoteMutedState();\n      for (const state of states) {\n        if (state.audioMuted) {\n        }\n        if (state.videoMuted) {\n        }\n      }\n      this.streamsList[+this.mainUid] = this.localStream;\n    } else {\n      // zego\n      const { client } = this;\n      const mainToken = <string>(\n        await this.loadLoginToken(\n          'https://sig-wstoken.zego.im:8282/tokenverify',\n          this.mainUid,\n        )\n      );\n      client.login(\n        this.roomId,\n        zegoRole.host,\n        mainToken,\n        (streamlist: any) => {\n          console.log('zego init success');\n          // 登录成功后处理，例如预览推拉流\n          console.log('streamlist :', streamlist);\n          // 播放返回的远端流\n          this.playRemoteStream(streamlist, this.client);\n          /* this.initStream() */\n          const option = {\n            audio: true,\n            client: this.client,\n            domId: this.domMap[1].main,\n            streamID: this.mainUid,\n            cameraId: this.device.cameraId[0],\n            microphoneId: this.device.microphoneId,\n          };\n          const constraints = {\n            audio: option.audio || false, // best use true, for mute opt\n            audioInput: option.microphoneId,\n            video: true,\n            videoInput: option.cameraId,\n            videoQuality: 2,\n            horizontal: true,\n          };\n          const dom = this.setVideoDomView({\n            domId: `${option.domId}`,\n            streamID: `${option.streamID}`,\n          });\n          client.startPreview(\n            dom,\n            constraints,\n            () => {\n              console.log('startPreview  success');\n              const result = client.startPublishingStream(`${option.streamID}`, dom);\n              console.log('client :', client);\n              console.log(`publish ${option.streamID} return ${result}`);\n              // resolve();\n            },\n            (error: any) => {\n              console.log('startPreview  error', error);\n              // reject();\n            },\n          );\n        },\n        (err: Error) => {\n          console.error('err :', err); // 登录失败后处理\n        },\n      );\n    }\n  }\n\n  // 设置线路\n  private getVideoDomView(domId: string) {\n    return <HTMLVideoElement>document.querySelector(`#${domId} video`);\n  }\n\n  // on\n  // off\n  // 发布流\n  async publish() {\n    if (!this.joined) {\n      console.warn('publish() - please join() firstly');\n      return;\n    }\n    if (this.published) {\n      console.warn('duplicate RtcClient.publish() observed');\n      return;\n    }\n    try {\n      await this.client.publish(this.localStream);\n    } catch (e) {\n      console.error(`failed to publish local stream ${e}`);\n      this.published = false;\n    }\n\n    this.published = true;\n  }\n\n  async unpublish() {\n    if (!this.joined) {\n      console.warn('unpublish() - please join() firstly');\n      return;\n    }\n    if (!this.published) {\n      console.warn('RtcClient.unpublish() called but not published yet');\n      return;\n    }\n\n    await this.client.unpublish(this.localStream);\n    this.published = false;\n  }\n  // 接受流\n\n  // 基础事件绑定，可能需要是主与副摄像头都可以？\n  public handleEvents(client: any) {\n    // let client = this.client;\n    if (this.line === 0) {\n      client.on('error', (err:string) => {\n        console.error(err);\n        super.emit('stream-error', err);\n      });\n      client.on('stream-added', (evt: any) => {\n        const { stream } = evt;\n        const uid = `${stream.getId()}`;\n        const userId = `${this.mainUid}`;\n        console.log('stream-added %s', uid);\n\n        if (uid.substr(2) === userId.substr(2)) return;\n        client.subscribe(stream, (err: Error) => {\n          console.error(err);\n        });\n      });\n\n      client.on('stream-subscribed', (evt: any) => {\n        // console.log(\"stream-subscribed :\");\n        const { stream } = evt;\n        stream.on('player-status-change', (evt: any) => {\n          console.log('media remote stream player-status-change :', evt);\n          if (evt.isErrorState && evt.status === 'paused') {\n            console.warn(`remote stream is paused unexpectedly. Trying to resume...`);\n            stream\n              .resume()\n              .then(() => {\n                console.log(`remote stream is resumed successfully`);\n              })\n              .catch((e: any) => {\n                console.error(\n                  `Failed to resume remote stream. Error ${e.name} Reason ${e.message}`,\n                );\n              });\n          }\n        });\n        const uid = `${stream.getId()}`;\n        console.log('stream-subscribed %s', uid);\n      });\n\n      client.on('connection-state-change', (state: string) => {\n        console.log('media connection-state-change :', state);\n      });\n\n      client.on('first-video-frame-decode', (evt: any) => {\n        const { stream } = evt;\n        const uid = `${stream.getId()}`;\n        console.log('first-video-frame-decode %s', uid);\n\n        if (!uid) return;\n        const mainUid = `${this.mainUid}`;\n        let domId;\n        // 如果是副摄像头\n        if (mainUid === uid) {\n          domId = this.domMap[1].vice;\n        } else {\n          const type = uid.substr(1, 1) === '0' ? 'main' : 'vice';\n          domId = this.domMap[0][type];\n        }\n        this.streamsList[uid] = stream;\n\n        stream.domId = domId;\n        // @ts-ignore\n        const el = document.querySelector(`#${stream.domId}`);\n        if (el) el.innerHTML = '';\n        stream.play(domId, { fit: 'contain' }, (err: any) => {\n          if (err && err.status !== 'aborted') {\n            // 播放失败，一般为浏览器策略阻止。引导用户用手势触发恢复播放。\n            super.emit('stream-play-fail', uid);\n            console.error(\n              `${stream.domId}-Stream play fail, desc: ${stream.domId}-Stream播放失败`,\n            );\n          }\n        });\n      });\n\n      ['camera-changed', 'playout-device-changed', 'recording-device-changed'].forEach(\n        event => {\n          client.on(event, (evt: any) => {\n            console.log(`${event} `, evt);\n            super.emit(event, evt);\n          });\n        },\n      );\n\n      ['mute-audio', 'unmute-audio', 'mute-video', 'unmute-video'].forEach(event => {\n        client.on(event, (evt: any) => {\n          var { uid } = evt;\n          console.log(`${event} %s`, uid);\n          super.emit(event, uid);\n        });\n      });\n\n      client.on('stream-removed', (evt: any) => {\n        const { stream } = evt;\n        var uid = stream.getId();\n\n        const mainUid = `${this.mainUid}`;\n        if (+mainUid === +uid) {\n          console.log('mainUid removed return :', uid);\n          return;\n        }\n\n        console.log('stream-removed %s', uid);\n        stream.stop();\n        delete this.streamsList[uid];\n        super.emit('stream-removed', uid);\n      });\n\n      client.on('peer-leave', (evt: any) => {\n        var { uid } = evt;\n        const mainUid = `${this.mainUid}`;\n\n        if (+mainUid === +uid) {\n          console.log('mainUid leave return :', uid);\n          return;\n        }\n\n        console.log('peer-leave %s', uid);\n        delete this.streamsList[uid];\n        super.emit('peer-leave', uid);\n      });\n\n      client.on('client-banned', (evt: any) => {\n        var { uid } = evt;\n        console.log('client-banned %s', uid);\n        // var attr = evt.attr;\n        super.emit('user-kicked', uid);\n      });\n    } else if (this.line === 1) {\n      client.on('stream-added', (evt: any) => {\n        const { stream } = evt;\n        const uid = `${stream.getId()}`;\n        const userId = `${this.mainUid}`;\n        console.log('stream-added %s', uid);\n\n        if (uid.substr(2) === userId.substr(2)) return;\n        client.subscribe(stream);\n      });\n\n      client.on('stream-subscribed', (evt: any) => {\n        const { stream } = evt;\n        console.log('stream :', stream);\n        // const uid: string = stream.getId() + \"\";\n        const { userId_: uid } = stream;\n        console.log('stream-subscribed %s', uid);\n        if (!uid) return;\n        const mainUid = `${this.mainUid}`;\n        let domId;\n        // 如果是副摄像头\n        if (mainUid === uid) {\n          domId = this.domMap[1].vice;\n        } else {\n          const type = uid.substr(1, 1) === '0' ? 'main' : 'vice';\n          domId = this.domMap[0][type];\n        }\n        this.streamsList[uid] = stream;\n        stream.domId = domId;\n        // @ts-ignore\n        const el = document.querySelector(`#${stream.domId}`);\n        if (el) el.innerHTML = '';\n\n        stream.on('player-state-changed', (evt: any) => {\n          console.log('media remote stream player-state-changed :', evt);\n          if (evt.state === 'PAUSED' && evt.reason === 'pause') {\n            console.warn(`remote stream is pause unexpectedly. Trying to resume...`);\n            stream\n              .resume()\n              .then(() => {\n                console.log(`remote stream is resumed successfully`);\n              })\n              .catch((e: any) => {\n                console.error(\n                  `Failed to resume remote stream. Error ${e.name} Reason ${e.message}`,\n                );\n              });\n          }\n        });\n\n        stream\n          .play(stream.domId, { objectFit: 'contain', muted: false })\n          .then(() => {\n            console.log('播放本地视频流成功 : %s', uid);\n          })\n          .catch((err: any) => {\n            const errorCode = err.getCode();\n            if (errorCode === 0x4043) {\n              const id = uid;\n              super.emit('stream-play-fail', id);\n              console.error(\n                `${stream.domId}-Stream play fail, desc: ${stream.domId}-Stream播放失败`,\n              );\n            }\n          });\n      });\n\n      client.on('connection-state-changed', (state: string) => {\n        console.log('media connection-state-change :', state);\n      });\n\n      ['camera-changed', 'playout-device-changed', 'recording-device-changed'].forEach(\n        event => {\n          client.on(event, (evt: any) => {\n            console.log(`${event} `, evt);\n            super.emit(event, evt);\n          });\n        },\n      );\n\n      ['mute-audio', 'unmute-audio', 'mute-video', 'unmute-video'].forEach(event => {\n        client.on(event, (evt: any) => {\n          // var uid = evt.uid;\n          const { userId: uid } = evt;\n          console.log(`${event} %s`, uid);\n          super.emit(event, uid);\n        });\n      });\n\n      client.on('stream-removed', (evt: any) => {\n        const { stream } = evt;\n        var uid = stream.getId();\n\n        const mainUid = `${this.mainUid}`;\n        if (+mainUid === +uid) {\n          console.log('mainUid removed return :', uid);\n          return;\n        }\n\n        console.log('stream-removed %s', uid);\n        stream.stop();\n        // delete this.streamsList[uid];\n        super.emit('stream-removed', uid);\n      });\n\n      client.on('peer-leave', (evt: any) => {\n        var { uid } = evt;\n        const mainUid = `${this.mainUid}`;\n\n        if (+mainUid === +uid) {\n          console.log('mainUid leave return :', uid);\n          return;\n        }\n\n        console.log('peer-leave %s', uid);\n        delete this.streamsList[uid];\n        super.emit('peer-leave', uid);\n      });\n\n      client.on('client-banned', (evt: any) => {\n        var { uid } = evt;\n        console.log('client-banned %s', uid);\n        // var attr = evt.attr;\n        super.emit('user-kicked', uid);\n      });\n\n      client.on('error', (err: any) => {\n        console.log('error', err);\n        super.emit('stream-error', err);\n      });\n    } else {\n      client.setUserStateUpdate(true);\n      client.onPlayStateUpdate = (type: number, streamid: string, error: any) => {\n        if (type == 0) {\n          console.info('play  success');\n        } else if (type == 2) {\n          console.info('play retry');\n        } else {\n          console.error(`play error ${error.msg}`);\n\n          var _msg = error.msg;\n          if (error.msg.indexOf('server session closed, reason: ') > -1) {\n            var code = error.msg.replace('server session closed, reason: ', '');\n            if (code == 21) {\n              _msg = '音频编解码不支持(opus)';\n            } else if (code == 22) {\n              _msg = '视频编解码不支持(H264)';\n            } else if (code == 20) {\n              _msg = 'sdp 解释错误';\n            }\n          }\n          alert(`拉流失败,reason = ${_msg}`);\n        }\n      };\n\n      client.onPublishStateUpdate = (type: number, streamid: string, error: any) => {\n        if (type == 0) {\n          console.info(' publish  success');\n        } else if (type == 2) {\n          console.info(' publish  retry');\n        } else {\n          console.error(`publish error ${error.msg}`);\n          var _msg = error.msg;\n          if (error.msg.indexOf('server session closed, reason: ') > -1) {\n            var code = error.msg.replace('server session closed, reason: ', '');\n            if (code == 21) {\n              _msg = '音频编解码不支持(opus)';\n            } else if (code == 22) {\n              _msg = '视频编解码不支持(H264)';\n            } else if (code == 20) {\n              _msg = 'sdp 解释错误';\n            }\n          }\n          alert(`推流失败,reason = ${_msg}`);\n        }\n      };\n\n      client.onUserStateUpdate = (roomId:number|string, userList:[]) => {\n        console.log('onUserStateUpdate :', roomId, userList);\n      };\n\n      client.onDisconnect = (error: any) => {\n        console.error(`onDisconnect ${JSON.stringify(error)}`);\n        // alert(\"网络连接已断开\" + JSON.stringify(error));\n        super.emit('stream-error', JSON.stringify(error));\n      };\n\n      client.onKickOut = (error: any) => {\n        console.error(`onKickOut ${JSON.stringify(error)}`);\n        super.emit('user-kicked', this.mainUid);\n      };\n\n      client.onStreamUpdated = (type: number, streamList: any[]) => {\n        if (type == 0) {\n          this.playRemoteStream(streamList, client);\n        } else if (type == 1) {\n          const streamsList = <any[]>Object.values(this.streamsList);\n          for (var k = 0; k < streamsList.length; k++) {\n            for (var j = 0; j < streamList.length; j++) {\n              const uid = streamsList[k].stream_id;\n              if (uid === streamList[j].stream_id) {\n                const mainUid = `${this.mainUid}`;\n                if (+mainUid === +uid) {\n                  console.log('mainUid removed return :', uid);\n                  return;\n                }\n\n                client.stopPlayingStream(uid);\n                delete this.streamsList[uid];\n\n                console.log('stream-removed %s', uid);\n                super.emit('stream-removed', uid);\n                break;\n              }\n            }\n          }\n        }\n      };\n    }\n  }\n\n  /**\n   * leave\n   */\n  public leave() {\n    const _self = this;\n    if (!this.client) {\n      console.error('Please Join First!');\n      return;\n    }\n    if (!this.joined) {\n      console.error('You are not in channel');\n      return;\n    }\n    if (this.line === 0) {\n      /**\n       * Leaves an AgoraRTC Channel\n       * This method enables a user to leave a channel.\n       * */\n      this.client.leave(\n        function () {\n          // stop stream\n          _self.localStream.stop();\n          // close stream\n          _self.localStream.close();\n          while (_self.remoteStreams.length > 0) {\n            var stream = _self.remoteStreams.shift();\n            // var id = stream.getId();\n            stream.stop();\n            // removeView(id);\n          }\n          _self.localStream = null;\n          _self.remoteStreams = [];\n          // _self.client = null;\n          console.log('client leaves channel success');\n          _self.published = false;\n          _self.joined = false;\n          console.warn('leave success');\n          _self.joined = false;\n        },\n        function (err:string) {\n          // console.log(\"channel leave failed\");\n          console.error(err);\n        },\n      );\n    } else if (this.line === 1) {\n      // ensure the local stream is unpublished before leaving.\n      this.unpublish();\n\n      // leave the room\n      this.client.leave();\n\n      this.localStream.stop();\n      this.localStream.close();\n      this.localStream = null;\n      this.joined = false;\n    } else {\n      console.info('leave room  and close stream');\n      // isPreviewed = false;\n      // this.client.stopPreview(previewVideo:htmlElement);\n      this.client.stopPublishingStream(this.mainUid);\n      var { streamsList } = this;\n      for (var i = 0; i < streamsList.length; i++) {\n        this.client.stopPlayingStream(streamsList[i].stream_id);\n      }\n      this.streamsList = {};\n\n      this.client.logout();\n      this.joined = false;\n    }\n  }\n\n  /**\n   *\n   * @param type\n   */\n  private getStream(type: number) {\n    const stream: any = this.localStream;\n    if (!stream) throw '流未初始化';\n\n    return stream;\n  }\n\n  /**\n   * muteAudio\n   */\n  public muteAudio(type = 0) {\n    const _self = this;\n    const { client } = this;\n    if (this.line === 2) {\n      const dom = _self.getVideoDomView(this.domMap[1].main);\n\n      return client.enableCamera(dom, true);\n    }\n    const stream: any = this.getStream(type);\n\n    return stream.muteAudio();\n  }\n\n  /**\n   * unmuteAudio\n   */\n  public unmuteAudio(type = 0) {\n    const stream: any = this.getStream(type);\n\n    return stream.unmuteAudio();\n  }\n\n  // ? zego ?\n  /**\n   * unmuteVideo\n   */\n  public unmuteVideo(type = 0) {\n    const stream: any = this.getStream(type);\n\n    return stream.unmuteVideo();\n  }\n\n  /**\n   * muteVideo\n   */\n  public muteVideo(type = 0) {\n    const stream: any = this.getStream(type);\n\n    return stream.muteVideo();\n  }\n\n  /**\n   * setVideoProfile\n   */\n  public setVideoProfile(type: number, dpi: string) {\n    const stream: any = this.getStream(type);\n\n    return stream.setVideoProfile(dpi);\n  }\n\n  /**\n   * resume\n   */\n  public resume(uid: number) {\n    const stream: any = this.streamsList[uid];\n    if (!stream) throw '流未初始化';\n\n    return stream.resume();\n  }\n\n  /**\n   * netData\n   */\n  private netData: NetDatas = {\n    up: new Map(),\n    down: new Map(),\n  };\n\n  /**\n   * 获取本地视频数据\n   */\n  private upDataLocal(name: string) {\n    const { client } = this;\n    const tempRet: any = {\n      video: {},\n      audio: {},\n    };\n    let _userId = '';\n    // 视频数据\n    if (this.line === 2) {\n      // zego\n      let _userId;\n      client.onPublishQualityUpdate = (streamid: string, quality: any) => {\n        _userId = streamid;\n        const {\n          videoBitrate: vbps,\n          videoFractionLost: vplr,\n          videoFPS: vfr,\n          videoTransferFPS: Tsb,\n          frameHeight: vfh,\n          frameWidth: vfw,\n          audioBitrate: abps,\n          audioBitrate: rkps,\n          currentRoundTripTime: ved,\n          audioFractionLost: aplr,\n        } = quality;\n\n        tempRet.video = {\n          type: `${_userId}`,\n          vbps,\n          vplr,\n          Tsb,\n          vfr,\n          vfh,\n          vfw,\n          ved,\n        };\n        tempRet.audio = {\n          abps,\n          rkps,\n          ved,\n          aplr,\n        };\n\n        _userId && this.netData.up.set(_userId, tempRet);\n      };\n    } else {\n      client.getLocalVideoStats((videoDatas: any) => {\n        // let userId: string = String(Reflect.ownKeys(videoDatas)[0]);\n        for (var userId in videoDatas) {\n          // console.log(\"userId\", userId)\n          _userId = userId;\n          try {\n            const {\n              // 实际可以拿到的数据\n              EncodeDelay: ved = '-', // 本地视频从采集到编码的延时\n              SendBitrate: vbps = '-', // 视频发送码率\n              SendFrameRate: vfr = '-', // 视频发送帧率\n              SendResolutionWidth: vfw = '-', // 视频发送分辨率宽度\n              SendResolutionHeight: vfh = '-', // 视频发送分辨率高度\n              TargetSendBitrate: Tsb = '-', // setVideoProfile 中设置的目标发送码率\n\n              // 实际拿不到,凑数\n              PacketLossRate: vplr = '-', // 远端音频丢包\n              ReceiveKps: rkps = '-', // 从远端接收的码率\n              End2EndDelay: vcd = '-', // 端到端延时（ms）\n            } = videoDatas[userId];\n\n            tempRet.video = {\n              type: `${_userId}`,\n              vbps,\n              Tsb,\n              vfr,\n              vfw,\n              vfh,\n              vplr,\n              ved,\n              rkps,\n              vcd,\n            };\n          } catch (error) {\n            console.log(error);\n          }\n        }\n      });\n\n      // 音频数据\n      client.getLocalAudioStats((audioData: any) => {\n        for (const userId in audioData) {\n          try {\n            const {\n              // 实际能获取\n              SendBitrate: abps = '-', // 视频发送码率\n              // 实际不能\n              PacketLossRate: aplr = '-',\n              End2EndDelay: acd = '-',\n            } = audioData[userId];\n            tempRet.audio = { abps, aplr, acd };\n          } catch (error) {\n            console.log(error);\n          }\n        }\n        // let userId: string = String(Reflect.ownKeys(audioData)[0])\n      });\n      _userId && this.netData.up.set(_userId, tempRet);\n    }\n  }\n\n  /**\n   * 获取远端视频数据\n   */\n  private upDataRemote() {\n    const { client } = this;\n    const tempRet: any = {};\n    if (this.line === 2) {\n      client.onPlayQualityUpdate = (stream_id: string, streamQuality: any) => {\n        const tempRet: any = {};\n        console.log('stream_id :', stream_id, streamQuality);\n        const {\n          videoBitrate: vbps,\n          videoFPS: vfr,\n          videoTransferFPS: Tsb,\n          frameHeight: vfh,\n          frameWidth: vfw,\n          audioBitrate: abps,\n          videoFractionLost: vplr,\n          audioBitrate: rkps,\n          currentRoundTripTime: ved,\n          audioFractionLost: aplr,\n        } = streamQuality;\n\n        tempRet.video = {\n          type: `${stream_id}`,\n          vbps,\n          Tsb,\n          vfr,\n          vfh,\n          vfw,\n          vplr,\n          ved,\n        };\n        tempRet.audio = {\n          abps,\n          rkps,\n          ved,\n          aplr,\n        };\n        stream_id && this.netData.down.set(stream_id, tempRet);\n      };\n    } else {\n      client.getRemoteVideoStats((videoDatas: any) => {\n        for (let i = 0; i < Reflect.ownKeys(videoDatas).length; i++) {\n          const userId = String(Reflect.ownKeys(videoDatas)[i]);\n          const {\n            // 实际可以拿到的数据\n            End2EndDelay: vcd = '-', // 端到端延时（ms）\n            PacketLossRate: vplr = '-', // 远端视频的丢包率\n            RecvBitrate: vbps = '-', // 视频接收码率\n            RecvResolutionHeight: vfh = '-',\n            RecvResolutionWidth: vfw = '-',\n            RenderFrameRate: vfr = '-', // 渲染帧率（fps）\n\n            // 实际拿不到,凑数\n            // none: vnq = \"-\"\n            ReceiveLocalKps: rlkps = '-', // 接受本地发送过来的码率\n          } = videoDatas[userId];\n\n          const isSelf = true; // userId.substr(2) === getUserId();\n          if (!isSelf) {\n            tempRet[userId] = {};\n            tempRet[userId].video = {\n              type: `${userId}`,\n              vbps,\n              vfr,\n              vfw,\n              vfh,\n              vplr,\n              vcd,\n              rlkps,\n            };\n          }\n        }\n      });\n      client.getRemoteAudioStats((audioData: any) => {\n        for (let i = 0; i < Reflect.ownKeys(audioData).length; i++) {\n          const userId = String(Reflect.ownKeys(audioData)[i]);\n          const {\n            // 实际可以拿到的数据\n            End2EndDelay: acd = '-',\n            PacketLossRate: aplr = '-',\n            RecvBitrate: abps = '-',\n\n            // 实际拿不到,凑数\n            none: anq = '-',\n          } = audioData[userId];\n          const isSelf = true; // userId.substr(2) === getUserId();\n          if (!isSelf) {\n            tempRet[userId] && (tempRet[userId].audio = { abps, aplr, acd, anq });\n          }\n        }\n      });\n      this.netData.down.clear();\n      for (const item in tempRet) {\n        this.netData.down.set(item, tempRet[item]);\n      }\n    }\n  }\n\n  /**\n   * 获取全量数据\n   */\n  public getNetStats() {\n    this.client && this.upDataLocal('main');\n    // this.viceClient && this.upDataLocal(\"vice\");\n    this.client && this.upDataRemote();\n\n    const ret: any = {\n      up: {},\n      down: {},\n    };\n    const iterator1 = this.netData.up.keys();\n    // {\"10228373\", \"11228373\"}\n    for (let i = 0; i < 2; i++) {\n      const temp = iterator1.next().value;\n      if (temp) {\n        ret.up[`${temp}`] = this.netData.up.get(temp);\n      } else {\n        break;\n      }\n    }\n\n    const iterator2 = this.netData.down.keys();\n    for (let i = 0; i < 2; i++) {\n      const temp = iterator2.next().value;\n      if (temp) {\n        ret.down[`${temp}`] = this.netData.down.get(temp);\n      } else {\n        break;\n      }\n    }\n\n    // 扁平化\n    const upArr: any = [];\n    if (ret.up !== {}) {\n      for (const item in ret.up) {\n        const { vbps, vfr, vfw, vfh, ved, vplr, Tsb, type, rkps } = ret.up[item].video;\n        const { abps, aplr, acd } = ret.up[item].audio;\n        upArr.push({\n          camera: '本地',\n          deviceName: 'web',\n          type,\n          vbps,\n          Tsb,\n          vplr,\n          ved,\n          vfr,\n          vfwh: `${vfw}*${vfh}`,\n          abps,\n          aplr,\n          acd,\n          rkps,\n        });\n      }\n    }\n    const downArr: any = [];\n    if (ret.down !== {}) {\n      for (const item in ret.down) {\n        const { vbps, vfr, vfw, vfh, vplr, vcd, type, rlkps } = ret.down[item].video;\n        const { abps, aplr, acd, anq } = ret.down[item].audio;\n        console.log(anq);\n        downArr.push({\n          camera: '远端',\n          deviceName: 'web',\n          type,\n          vbps,\n          vplr,\n          vcd,\n          vfr,\n          vfwh: `${vfw}*${vfh}`,\n          abps,\n          aplr,\n          acd,\n          rlkps,\n        });\n      }\n    }\n\n    const refFinal = {\n      up: upArr,\n      down: downArr,\n    };\n    return refFinal;\n  }\n\n  public stopNetStats() {\n    // ? 空函数 ?\n    if (this.line == 2) {\n      this.client.onPlayQualityUpdate = () => { };\n      this.client.onPublishQualityUpdate = () => { };\n    }\n  }\n}\n"],"names":["ZRTC"],"mappings":"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"}